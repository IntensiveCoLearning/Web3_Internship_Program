---
timezone: UTC+8
---

# DrakenZeng

**GitHub ID:** Darkells

**Telegram:** @Allen Draken

## Self-introduction

待人真诚

## Notes

<!-- Content_START -->
# 2025-08-09

### 预言机问题
	智能合约无法获取区块链以外的数据，外部API提供的数据和任何其他链下资源都无法获取。

为什么区块链没法主动获取外部数据，因为区块链是一个确定性的系统，每个操作都需要网络中大部分节点验证，通过达成共识最终写入区块。如果每个节点执行操作会得到不同的结果则无法通过验证达成共识。
因此需要一个第三方的工具，预言机给提供数据。

### 预言机种类
- 中心化预言机
  - 采用单一节点通过数据源获取数据，再将数据推送到链上的智能合约。
   - 优势
     1. **低成本**： 单一数据和一次上链操作，部署、运行成本低。
     2. **低延迟**：数据实时推送到链上，适合高频率更新场景。
     3. **架构简单**：架构清晰，开发周期短，维护成本低。
     4. **灵活性高**：自由调整数据源、更新频率以及推送逻辑，适应业务变化快的项目。
     5. **高吞吐**：适合需要频繁喂价或大批量数据更新的应用。
   - 缺陷
     1. **信任单点风险**：用户需无条件信任数据源，如果被恶意篡改数据会导致链上智能合约执行错误逻辑，在DeFi中可能直接导致清算、套利、价格操纵等大规模损失。
     2. **单点故障风险**：预言机服务遇到宕机、被攻击、不可抗力因素导致不可用，链上智能合约会失效。
     3. **透明度不足**：用户无法验证数据来源、采集方法和处理过程。
     4. **易受外部攻击操纵**：攻击者攻击中心化预言机成本远低于去中心化多节点预言机网络。
     5. **合规与审查风险**：中心化预言机运营方可能受到监管机构、政府或第三方支配，拒绝提供某类数据或对特定用户封锁服务。
   - 总结：中心化预言机破坏了区块链“去信任化”原则。
- 去中心化预言机
  - 多个数据节点形成中心预言机网络，每个节点都会收集数据，达成共识输入到区块链上的智能合约。
   - 优势：
     1. **去信任化**：数据由多个独立节点采集和签名，通过共识聚合，减少对单一数据源的依赖。
     2. **抗篡改性**：攻击者需要同时控制多数节点才能操纵数据，成本极高。
     3. **高可用性**：多节点冗余，部分节点宕机，系统仍可以正常提供数据。
     4. **透明性**：节点列表、签名、数据来源和价格计算方式通常是公开可审计的。
     5. **适合高价值场景**：适用于DeFi借贷、衍生品、清算等对数据正确性要求高的应用。
   - 缺陷：
     1. **成本高**：多节点运行、链上聚合交易、频繁更新会有较高的gas和运营成本。
     2. **更新延迟**：需要等待多节点提交数据并聚合，实时性不如中心化单源。
     3. **数据源依赖问题**：存在多节点可能依赖同一交易所或者API，如何数据源出错，也会影响结果。
     4. **复杂性高**：协议设计、节点激励、惩罚机制和签名聚合逻辑较复杂，增加了运维和审计难度。
     5. **潜在经济攻击**：攻击者可能在预言机更新间隔内操纵数据源，进行闪电贷套利或清算攻击。

### 其他方式实现预言机功能
- 手动喂价
  - 由可信节点/多签钱包定期更新链上数据。
  - 优点：简单实现
  - 缺点：人工成本高，易出错或延迟。
- 跨链消息传递
  - 从另一条链上同步已存在的可信数据，比如从Binance Smart Chain同步价格到以太坊。

### Uniswap的“喂价”机制
	Uniswap不会主动去获取外部价格，而是利用自身的AMM（自动做市商）恒定乘积公式
					x * y  = k
在任何时刻，池子中两种代币的余额比值y/x天然反映了市场价格。
当有人交易时，储备量发生变化，价格随之调整。
							价格 = 池中ETH数量 / 池中USDC数量​
这个价格是反映当前池子的状态。
	
- 可以通过闪电贷进行操纵
  - 闪电贷允许用户在单个交易内借入大量资产，执行操作之后立即归还，几乎无需担保。
  - 攻击者可以利用闪电贷大量买入或卖出某资产，在Uniswap池内瞬间改变代币储备比例（价格）。
  - 价格会瞬间偏离真实市场价格，价格被人为的拉高或压低。
  - 利用这个被操纵的价格，在依赖该价格的其他智能合约（借贷、清算、衍生品合约）中套利。
  -最后在同一个交易内还回闪电贷，完成整个操作，没有持有被借资产风险。
- 成功因素：
  - 交易是原子性的：所有操作在一个区块内完成，外部观察者无法在中间干预。
  - 当前储备比是瞬时的，价格没有平滑机制，瞬间的储备变化直接反映为价格变化。

#### 时间加权平均价格（TWAP）
- 在Uniswap V1中，只能读取当前池子的储备比，价格是瞬时快照，容易被闪电贷操纵。
- Uniswap V2 引入了“累计价格”概念
  - 每个区块都会更新一次价格累计值，累计值是“价格 * 时间”的累计和。
  - 通过两个十九点的累积价格差，除以时间差，可以算出这段时间的平均价格(TWAP)
### 链上价格与市场真实价格关系

思考场景：
- 市场价 ETH = 4000 USDT
- Uniswap池内即时价格 = 3900 USDT
- 且没有新的流动性注入或者交易发生

1. 链上价格是池内储备比例的反映
2. 存在偏差
    - 交易频率和流动性影响
    - 套利机会
    - 套利过程会推动池内价格回归市场价：
      - 例如当前场景可以在Uniswap买入ETH，推高池内ETH价格。
      - 直到价格差被消除或套利利润变小到不可行为止。
3. 没有新流动性注入不代表价格失真
    - 流动性注入只是池子容量的变化，价格由交易行为决定。
    - 如果没人交易，价格静止，但这不等于“价格真实失真”，而是“价格未及时更新”。
    - 市场通过套利机制自动修正价格偏差。
4. 总结
    - Uniswap的即时价格是链上状态快照，不一定与市场价完全一致。
    - 价格失真会被套利者修正，通过买卖行为推动池内价格回归市场价。
    - 流动性注入影响池容量和滑点，但不直接决定价格是否失真。

# 2025-08-07

### 今日学习内容

## WTF Solidity基础 101
1. 合约结构
2. 变量类型
3. 函数
4. 数据位置
5. 控制结构
6. 映射与结构体
7. 控制流
8. 事件
9. 构造器与修饰器
10. 继承

## Ethernaut 学习
目前已完成第三关
- 心得记录：在remix上部署攻击合约时，踩坑，攻击频率过高会出现在同一区块上执行，其次通过sepolia etherscan的Lastest Block查看区块变动存在延时。

## Web3 法律合规学习
+ Web3存在的违法行为
+ 作为技术人员如何去避免参与到违规项目

# 2025-08-06

### 稳定币的三大类型
1.  法币抵押型（Fiat-Collateralized Stablecoins）
  - 定义：由中心化机构发行，1:1 锚定法币（如美元、欧元），由托管银行账户或储备资产支持。
  - 特点：
    - 优点：价格稳定，风险低，用户信任度高。
    - 缺点：中心化、依赖托管机构，面临监管风险。
  - 代表项目：
    - USDT（Tether）：最早、流通量最大，锚定 USD。
    - USDC（Circle）：合规性强，监管友好。
    - BUSD（Binance USD）：由 Binance 与 Paxos 发行。


2. 加密资产抵押型（Crypto-Collateralized Stablecoins）
  - 定义：通过超额抵押加密资产（如 ETH、WBTC）发行，依靠智能合约和清算机制维持锚定。
  - 特点：
    - 优点：去中心化，不依赖传统银行系统。
    - 缺点：价格波动风险高，需超额抵押（通常 150%-200%），清算复杂。
  - 代表项目：
    - DAI（MakerDAO）：锚定 USD，通过超额抵押 ETH、USDC 等资产生成。
    - sUSD（Synthetix）：基于合成资产协议发行。
    - LUSD（Liquity）：基于 ETH 抵押，最低抵押率 110%。

3. 算法稳定币（Algorithmic Stablecoins）
  - 定义：不依赖抵押资产，通过算法调节代币供应维持价格锚定（类似央行货币政策）。
  - 机制：
    - 当价格高于 1 美元 → 增发代币降低价格。
    - 当价格低于 1 美元 → 销毁代币提高价格。
  - 特点：
    - 优点：无抵押需求，资本效率高。
    - 缺点：风险极高，易发生“死亡螺旋”。
  - 代表项目：
    - UST（Terra）：通过 LUNA 铸造/销毁维持锚定（已崩盘）。
    - AMPL（Ampleforth）：通过供应弹性调整价格。

# 2025-08-05

# 以太坊基础概念笔记

## 1. 以太坊简介
- **定义**：以太坊（Ethereum）是一个开源、去中心化的区块链平台，提供智能合约和去中心化应用（Dapps）支持。
- **创始人**：Vitalik Buterin，提出于 2013-2014 年，2014 年正式启动。
- **核心创新**：智能合约（Smart Contracts）——存储在区块链上的自动化执行代码。
- **定位**：区块链 2.0，目标是“世界计算机”，支持更广泛的应用场景。
- **原生代币**：以太币（ETH），用于支付交易和 Gas 费用。
- **当前地位**：市值全球第二，仅次于比特币；The Merge 后，年通胀率约 0.2%-0.8%。

---

## 2. Ethereum vs Bitcoin
| 维度         | 比特币（BTC）                   | 以太坊（ETH）                      |
|-------------|--------------------------------|-----------------------------------|
| 目标与定位    | 去中心化数字货币，强调稀缺性          | 去中心化平台，支持智能合约和 Dapps     |
| 编程能力      | 脚本语言有限                      | 图灵完备，支持复杂逻辑（Solidity）     |
| 共识机制      | PoW（挖矿）                     | PoS（The Merge 后）                |
| 区块时间      | 约 10 分钟                      | 约 12 秒                           |
| 经济模型      | 总量固定，抗通胀                   | 灵活供应，可能呈通缩（EIP-1559）       |
| 应用场景      | 数字黄金，价值存储                   | DeFi、NFT、DAO、Dapps            |

---

## 3. 以太坊发展与升级
### **阶段 1：以太坊 1.0（PoW）**
- 使用工作量证明（PoW），依赖矿工算力。
- 问题：能耗高、TPS 低（约 30 笔/秒）、Gas 费用高。

### **阶段 2：以太坊 2.0 & The Merge**
- **信标链（Beacon Chain）**：2020 年启动 PoS。
- **The Merge（2022.9.15）**：PoW → PoS，能耗降低 99.95%。
- **PoS 特点**：
  - 验证者需质押 32 ETH。
  - 奖励 + Slashing 惩罚。
  - 区块确认更快，经济安全性提升。

### **未来升级路线**
- **分片（Sharding）**：数据分片，配合 L2 降低成本。
- **EIP-4844（已上线）**：Blob 交易，降低 L2 成本 70%-90%。
- **Layer 2 扩展**：Rollups（Optimistic、ZK）。
- **ZK-Rollup**：批量验证，快速低成本。
- **其他**：Verkle 树优化、EVM 性能增强。

---

## 4. 以太坊生态层次
- **L1 主网**：共识安全层，EVM，账户系统。
- **L2 扩展**：Rollups（Arbitrum、Optimism、zkSync）、侧链（Polygon）。
- **应用层**：
  - DeFi：Uniswap、Aave、Compound。
  - NFT：OpenSea、Foundation。
  - 钱包：MetaMask、Rainbow。
  - DAO：Snapshot、Aragon。

---

## 5. 核心机制
### **账户系统**
- **EOA**（外部账户）：由用户私钥控制。
- **CA**（合约账户）：由智能合约代码控制。
- **关键字段**：Nonce、余额、CodeHash、StorageRoot。

### **Gas 模型**
- **Gas = 计算量单位**，防止滥用。
- 费用 = Gas Used × Gas Price。
- **EIP-1559**：
  - Base Fee：销毁，助力 ETH 通缩。
  - Tip：奖励验证者。

### **以太坊虚拟机（EVM）**
- 图灵完备，运行智能合约。
- 每个节点都执行相同代码，确保一致性。
- 隔离执行，防止恶意代码破坏网络。

---

## 6. 以太坊文化与价值观
- 去中心化治理（社区共识、EIP 流程）。
- 无需许可、开放性。
- 抗审查性。
- 密码朋克精神：代码即法律。
- 可持续发展：环保（PoS）、长期主义。


# Web3安全笔记
## DeFiHackLabs
- 是一个Web3安全社区，在全球拥有超过3900名成员和292名白帽黑客
- 致力于汇聚多方安全专业鱼创新力量，打造更安全、更具韧性的Web3生态系
- 为传统和新兴人才进入Web3安全领域牵线搭桥，通过战略合作伙伴关系和教育增强生态系统的稳健发展。

## Unphishable 反钓鱼训练平台 和 ScamSniffer

# 2025-08-04

## 区块链定义与特性
* 定义：去中心化、分布式账本，数据按时间顺序串联成“区块链”
  * 特性：
    1. 不可篡改：区块通过哈希相连，修改需重写全部后续区块
    2. 公开透明 + 匿名：交易可查，钱包地址无实名
    3. 快速交易：全球无障碍结算

## 比特币（BTC）
* 比特币是矿工通过维护网络获得奖励（挖矿）
* 比特币具备货币属性：稀缺性 + 可转账 + 去中心化
* 特点：匿名、公开、不可篡改、跨境便捷

## 区块链的核心
* 去中心化网络：节点（矿工）共同维持
* 代币激励机制：Gas Fee + 区块奖励

### 交易流程：
发起交易 → 广播 → 验证 → 打包成块 → 上链 → 发放奖励

## 区块链类型:
* 公链: 
  1. 任何人都可以加入
  2. 数据全公开
  3. 采用去中心化投票管理
  4. 应用场景主要是加密货币、存证
  5. 缺点是决策效率低，维护成本高
* 联盟链:
  1. 采用邀请制/审批方式
  2. 数据仅联盟内部可见
  3. 采用多方治理
  4. 应用场景主要是金融、供应链
  5. 优点是效率比公链高，隐私比公链好，灵活性还是欠缺
* 私链: 
  1. 采用严格的审批，成员固定
  2. 数据仅内部可见
  3. 管理模式中心化
  4. 应用场景主要是企业内部系统
  5. 优点是效率极高，隐私极强，但缺乏公链的透明性

## Web2 Web3.0 Web3
|       | 控制权 | 数据存储 | 技术 | 场景 |
| :----: | :----: | :----: | :----: | :----: |
| web 2  | 平台 | 中心服务器 | JS | 微信、抖音 |
| web 3.0 | 部分开放 | 语义结构化 | RDF/OWL | 语义网搜索 |
| web 3  | 用户自治 | 区块链/IPFS | 智能合约 | 去中心化金融、NFT |
* Web 3.0 = 语义网（结构化数据），不等于区块链
* Web3 = 区块链驱动，强调去中心化，去信任化

## 去中心化的优势与挑战
* 优势:
  * 信任最小化
  * 抗审查 + 高弹性
  * 用户数据主权
  * 创新生态
* 挑战:
  * 可拓展性差
  * 安全与治理
  * 用户体验差
  * 法律合规风险


# 2025.08.03


<!-- Content_END -->
